---
title: "Conditionals API Reference"
description: "Documentation for working with conditional feature interventions"
---

The Conditionals API provides methods for creating and managing conditional feature interventions. Conditionals allow you to define when certain feature modifications should be applied based on the activation levels of other features.

## Core Classes

### Conditional

A class representing a single conditional expression comparing features or feature groups.

**Properties:**

<ResponseField name="left_hand" type="FeatureGroup">
  The feature group being evaluated
</ResponseField>

<ResponseField name="right_hand" type="Feature | FeatureGroup | float">
  The value to compare against
</ResponseField>

<ResponseField name="operator" type="string">
  The comparison operator (`"=="`, `"!="`, `"<="`, `"<"`, `">="`, `">"`)
</ResponseField>

**Methods:**

<ResponseField name="json" type="method">
  Convert conditional to JSON format
</ResponseField>

<ResponseField name="from_json" type="method">
  Create conditional from JSON data
</ResponseField>

**Example:**

```python
# Create a conditional checking if a feature's activation is above 0.75
whale_feature = client.features.search("whales", model=variant, top_k=1)
condition = whale_feature.gt(0.75)  # Using method instead of > operator

# Use the conditional to trigger feature modifications
variant.set_when(condition, {
    pirate_feature: 1.0
})
```

### ConditionalGroup

A class for grouping multiple conditions with logical operators.

**Properties:**

<ResponseField name="conditionals" type="list[Conditional]">
  List of conditions in the group
</ResponseField>

<ResponseField name="operator" type="string">
  Logical operator joining the conditions (`"AND"` or `"OR"`)
</ResponseField>

**Methods:**

<ResponseField name="json" type="method">
  Convert conditional group to JSON format
</ResponseField>

<ResponseField name="from_json" type="method">
  Create conditional group from JSON data
</ResponseField>

**Example:**

```python
# Create conditions
condition1 = whale_feature.gt(0.5)
condition2 = ocean_feature.gt(0.3)

# Combine with logical operators
combined = condition1.and_(condition2)  # AND
combined = condition1.or_(condition2)   # OR

# Use in variant
variant.set_when(combined, {
    pirate_feature: 1.0
})
```

### AutoConditional

Helps to automatically create synthetic contrastive data to find relevant features and create conditionals.

**Parameters:**

<ResponseField name="query" type="string" required>
  Search query to find relevant features
</ResponseField>

<ResponseField name="client" type="Client" required>
  Goodfire client instance
</ResponseField>

<ResponseField name="model" type="string" required>
  Model identifier
</ResponseField>

<ResponseField name="num_features_to_use" type="integer" default={5}>
  Number of features to include in the conditional
</ResponseField>

**Example:**

```python
# Create an automatic conditional for detecting animal-related content
conditional = goodfire.conditional.AutoConditional(
    "animals",
    client=client,
    model="meta-llama/Llama-3.3-70B-Instruct",
    num_features_to_use=5
)

# Use the conditional
variant.set_when(conditional, {
    pirate_features[0]: 0.5
})
```

## Using Conditionals with Variants

### set_when()

Set feature modifications that should be applied when a condition is met.

**Example:**

```python
# Apply pirate features when whale-related content is detected
variant.set_when(whale_feature.gt(0.75), {
    pirate_features[1]: 1.0
})

response = client.chat.completions.create(
    [{"role": "user", "content": "Tell me about whales."}],
    model=variant
)
```

### abort_when()

Configure the model to abort generation when a condition is met.

**Example:**

```python
# Abort if whale-related content is detected
variant.abort_when(whale_feature.gt(0.75))

try:
    response = client.chat.completions.create(
        [{"role": "user", "content": "Tell me about whales."}],
        model=variant
    )
except goodfire.exceptions.InferenceAbortedException:
    # Handle the aborted generation
    pass
```

## Comparison Methods

Conditionals support the following comparison methods:

- `eq()` - Equal to
- `ne()` - Not equal to
- `le()` - Less than or equal to
- `lt()` - Less than
- `ge()` - Greater than or equal to
- `gt()` - Greater than

Conditional groups support these logical methods:

- `and_()` - AND
- `or_()` - OR

**Example:**

```python
# Combine multiple conditions
complex_condition = (
    whale_feature.gt(0.5)
    .and_(ocean_feature.gt(0.3))
    .or_(ship_feature.gt(0.7))
)

variant.set_when(complex_condition, {
    pirate_features[0]: 1.0
})
```
